/*
 * PrepAdherenceVulnerabilityEndEvent.cpp
 *
 *  Created on: Aug 5 , 2019
 *      Author: Babak
 */

#include "PrepAdherenceVulnerabilityEndEvent.h"
#include "Stats.h"

namespace TransModel {

PrepAdherenceVulnerabilityEndEvent::PrepAdherenceVulnerabilityEndEvent(std::shared_ptr<Person> person, double timestamp, double original_val_to_restore) :
        person_(person), timestamp_(timestamp), original_val_to_restore_(original_val_to_restore){
}

void PrepAdherenceVulnerabilityEndEvent::operator()() {

    //std::cout <<" PrepAdherenceVulnerabilityEndEvent: timestamp: " <<timestamp_<< ", person.id: "<< person_ -> id();
    //std::cout <<", current prob val:"<< person_ -> prepParameters().prepEffectiveness()<< ", original_val_to_restore: " << original_val_to_restore_<< std::endl;

    // might be dead or may have gone off prep by becoming infected
    // prior to this event occuring
    if (!person_->isDead() && person_->isOnPrep()) {
        
        //std::cout <<" PrepAdherenceVulnerabilityEndEvent: timestamp: "
        person_ -> setPrepAdherenceProbability(original_val_to_restore_);
    }
}

PrepAdherenceVulnerabilityEndEvent::~PrepAdherenceVulnerabilityEndEvent() {
}

} /* namespace TransModel */

